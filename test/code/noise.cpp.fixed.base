/* This code was generated by the Vult compiler v1-dev https://github.com/vult-dsp/vult */

#include "noise.h"

fix16_t Noise_pinker(Noise_pinker_type& _ctx, fix16_t x) {
   fix16_t b0 = 0x718 /* 0.027713 */;
   fix16_t b1 = 0x718 /* 0.027713 */;
   fix16_t a1 = -0xf1cf /* -0.944574 */;
   fix16_t w0 = x + (- fix_mul(a1, _ctx.w1));
   fix16_t y0 = fix_mul(b0, w0) + fix_mul(b1, _ctx.w1);
   _ctx.w1 = w0;
   return y0;
}

fix16_t Noise_process(Noise_process_type& _ctx, fix16_t color) {
   _ctx.x1 = (7919 + 17389 * _ctx.x1) % 32768;
   fix16_t y1 = fix_mul(0x2 /* 0.000031 */, int_to_fix(_ctx.x1));
   _ctx.x2 = (12553 + 27449 * _ctx.x2) % 32768;
   fix16_t y2 = fix_mul(0x2 /* 0.000031 */, int_to_fix(_ctx.x2));
   fix16_t out = 0x0 /* 0.000000 */;
   if (color > 0x8000 /* 0.500000 */) {
      out = Noise_pinker(_ctx.inst_16d3d, y1 + (- y2));
   }
   else {
      out = y1 + (- y2);
   }
   return fix_mul(0x20000 /* 2.000000 */, out);
}

