/* This code was generated by the Vult compiler v1-dev https://github.com/vult-dsp/vult */

#include "saw_r.h"

float Saw_r_process(Saw_r_process_type& _ctx, float cv) {
   if (Util_change(_ctx.inst_1b040, cv)) {
      _ctx.inc = Util_cvToRate(cv);
   }
   float i = 0.0f;
   if (_ctx.inc < float_eps()) {
      i = float_eps();
   }
   else {
      i = _ctx.inc;
   }
   _ctx.phase = 2.0f * _ctx.inc + _ctx.phase;
   if (_ctx.phase > 2.0f) {
      _ctx.phase = -2.0f + _ctx.phase;
   }
   else {
      _ctx.phase = _ctx.phase;
   }
   float ph = -1.0f + _ctx.phase;
   float o = 0.0f;
   if (ph >= (1.0f + (- i))) {
      float b = (1.0f + (- i) + (- ph)) / i;
      o = ph + b * fabsf(b);
   }
   else {
      if (ph <= (-1.0f + i)) {
         float b = (-1.0f + i + (- ph)) / i;
         o = ph + b * fabsf(b);
      }
      else {
         o = ph;
      }
   }
   return o;
}

